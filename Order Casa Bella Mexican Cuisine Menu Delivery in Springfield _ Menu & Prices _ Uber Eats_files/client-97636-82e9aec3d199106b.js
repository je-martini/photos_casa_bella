(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[97636],{4434:e=>{e.exports=function(e){var t,E;if("function"!=typeof e)throw new Error("expected a function but got "+e);return function(){return t||(t=!0,E=e.apply(this,arguments),e=void 0),E}}},28071:(e,t,E)=>{"use strict";E.d(t,{Z:()=>M});var r=E(36151),i=E(74622),n=E(15070),o=E(98976),a=E(71576),_=E(24934),s=E(62436),O=E(92005),R=E(82600),u=E(70587),c=E(24316),T=E(53811),S=E(59738),D=E(44606),d=E(46008);var I=E(33535),l=E(19759),N=E(38777),U=E(35455),A=E(66316),p=E(34062),P=E(20568);var f=E(85427),C=E(34626),L=E(35291),y=E(60849),m=E(60047);const V=e=>{const t="createDraftOrderV2",E=(0,a.Z)(t,!0),_=(0,l.m6)(t),O=(0,I.ZP)(),{user:R}=(0,C.Z)(),u=R.data?.isLoggedIn,c=(0,n.v)((e=>{let{delegatedBooking:t}=e;return t})),S=(0,L.a)(),D=function(){const e=(0,p.E)(),t=(0,I.ZP)(),{updateDraftOrderV2:E}=(0,A.Z)(),{updateUseCredits:r}=(0,s.IM)(),i=(0,P.Z)("getCheckoutPresentationV1",{continueOnUnmount:!0});return async n=>{if(e)try{const e=((await i({payloadTypes:["paymentProfilesEligibility"],draftOrderUUID:n.uuid}))?.checkoutPayloads?.paymentProfilesEligibility?.eligibilityPayloadList??[]).map((e=>e.isEligible?{paymentProfileUUID:e?.paymentProfileUUID}:void 0)).filter(Boolean);e.length>0&&(r(!1),await E({draftOrderUUID:n.uuid,extraPaymentProfiles:e,useCredits:!1}),t("eats:healthcare_eligible_order_created",{draftOrderUuid:n.uuid}))}catch(e){}}}(),d=(0,r.useCallback)(l.qO,[]),N=(0,r.useCallback)((t=>{const r=E(t);return e?.(),r}),[E,e]),U=(0,i.useQueryClient)(),f=(0,r.useCallback)(((e,t)=>{O(_,d(t,u,c)),e?.cartsView&&U.setQueryData(T.x,e.cartsView),S.enqueue(e?.draftOrderPresentationResponse),e?.draftOrder&&D(e.draftOrder)}),[O,_,d,u,c,S,U,D]),y=(0,r.useCallback)(((e,t)=>{O(_,{...d(t),error:e})}),[d,O,_]),m=(0,i.useMutation)(N,{onSuccess:f,onError:y});return{createDraftOrderMaybe:(0,o.rF)(m),createDraftOrderV2:m.mutateAsync}};function M(e,t,E){const{createDraftOrderV2:i,createDraftOrderMaybe:o}=V(t),{paymentProfileUuid:a}=(0,R.Z)(),{selectedPromotionUuid:T,skipApplyingPromotion:l}=(0,n.v)((e=>{let{checkout:t}=e;return t}))||{},{deliveryInstructions:A}=(0,_.pK)(),p=A.data?.selectedInstruction?.interactionType||A.data?.preferredInteractionType||f.$$.interactionType,P=(0,O.Z)(),{paymentIntent:C}=(0,s.IM)(),L="business"===C,{isInMulticart:M}=(0,c.Z)(),g=(0,I.ZP)(),h=(0,N.W)(),{isRemoveProfileTypeFromDraftOrderEnabled:b}={isRemoveProfileTypeFromDraftOrderEnabled:(0,y.ip)({...m.l.is_remove_profile_type_from_draft_order_enabled,defaultValue:!1})};return{createDraftOrderMaybe:o,createDraftOrder:(0,r.useCallback)((async t=>{let{shoppingCartItems:r,isBandwagon:n,groupOrderStoreUUID:o,spendingLimit:_,currencyCode:s,businessDetails:O,billSplitOption:R,addParticipantsIntended:c,displayName:I,cartLockOptions:N,deliveryTime:A,actionMeta:f,promotionUuid:y,handledHighCapacityOrderMetadata:m,repeatOrderOptions:V,primaryDraftOrderUUID:Y,draftOrderPresentationContext:v,deliveryType:B,addOnOfferContext:G}=t;const K=y||T;let H={isMulticart:M,shoppingCartItems:r,useCredits:!0,extraPaymentProfiles:[],promotionOptions:{autoApplyPromotionUUIDs:[],selectedPromotionInstanceUUIDs:K?[K]:[],skipApplyingPromotion:l},deliveryTime:A,deliveryType:n?"BANDWAGON":"ASAP",groupOrderStoreUUID:o,spendingLimit:_,currencyCode:s,addParticipantsIntended:c,interactionType:p,paymentProfileUUID:a,billSplitOption:R,displayName:I,checkMultipleDraftOrdersCap:M,cartLockOptions:N,actionMeta:f,draftOrderPresentationContext:v,...Y&&{createBundleGroup:{primaryDraftOrderUUID:Y}},addOnOfferContext:G};B&&(H.deliveryType=B);const W=!b||Boolean(O?.profileUUID||!1);return H.businessDetails=O&&W?{profileUUID:O.profileUUID,profileType:O.profileType,policyUUID:O.policyUUID,policyVersion:O.policyVersion,expenseCode:O.expenseCode,expenseMemo:O.expenseMemo,expenseTrip:O.expenseTrip,businessTrip:O.businessTrip,organizationUUID:O.organizationUUID,voucherUUID:O.voucherUUID,voucherPolicyVersion:O.voucherPolicyVersion}:{},b||(H.businessDetails.profileType=C),!L&&P?.voucherUUID&&R!==u.x.SPLIT_BY_SUBTOTAL&&(H.businessDetails.voucherPolicyVersion=P?.voucherData?.policy?.version,H.businessDetails.voucherUUID=P?.voucherUUID),m&&(H.handledHighCapacityOrderMetadata={hhcOrderSize:m.hhcOrderSize}),V&&(H.repeatSchedule=(0,S.OL)({repeatOrderOptions:V})),null!=r&&(H.shoppingCartItems=((e,t)=>e.map((e=>(e.itemQuantity?.inSellableUnit?.measurementUnit?.measurementType!==d.RV.MEASUREMENT_TYPE_COUNT||!e.itemQuantity.inSellableUnit||e.itemQuantity?.inSellableUnit?.value&&D.Tf.from(e.itemQuantity.inSellableUnit.value).toFloat()===e.quantity||(t&&t(e.itemQuantity),e.itemQuantity.inSellableUnit.value=D.Tf.from(e.quantity).toCoefficientDecimal()),e))))(r,(t=>{g("eats:create_draft_order_quantity_item_quantity_mismatch",{itemQuantity:JSON.stringify(t),source:e,request:JSON.stringify(H)})}))),"reorder"===e&&(H.shoppingCartItems=H.shoppingCartItems?.map((e=>({...e,itemQuantity:{...e.itemQuantity,inPriceableUnit:null}})))),h?.isDelegatedBooking&&(H=(0,U.yj)(H,h)),E&&(H.creationSurface=E),i(H)}),[M,i,p,L,a,C,T,P.voucherData?.policy?.version,P.voucherUUID,l])}}},34062:(e,t,E)=>{"use strict";E.d(t,{E:()=>n});var r=E(60849),i=E(97763);function n(){return(0,r.ip)({...i.J.is_healthcare_card_enabled,defaultValue:!1})}},49160:(e,t,E)=>{"use strict";E.d(t,{Z:()=>o});var r=E(91631),i=E(33825),n=E(79640);function o(e){const t=(0,r.UO)().sectionUuid,E=(0,i.Z)();if(!e)return null;if("USE_SECTION_AS_CATEGORY"===e.menuDisplayType)return(0,n.xk)(e);const o=(e.sections||[]).map((e=>e.uuid)),a=o.find((e=>e===t))||o[0];return t&&!E&&a?a:(0,n.xk)(e)}},80803:(e,t,E)=>{"use strict";E.d(t,{IJ:()=>I,Jq:()=>U,dI:()=>N,eX:()=>D,kF:()=>S,tl:()=>d,uD:()=>l});var r=E(67106),i=E(83960),n=E(97375),o=E(55758),a=E(33535),_=E(74057),s=E(36151),O=E(50818),R=E(57578),u=E(40964),c=E(49160),T=E(43832);function S(e){return e.isDraftOrderCreator?n.B.groupOrderCreator:e.isDraftOrderParticipant?n.B.groupOrderParticipant:n.B.singleOrder}function D(e){const t=(0,_.Z)(e);return"object"==typeof t.deliveryTime&&"scheduled"in t.deliveryTime?n.s.scheduled:n.s.asap}const d=(e,t)=>{if(!t)return"Single Level List";const E=(0,u.A)(e)?"Multi Level":"Single Level",r=e.catalogSectionsMap?.[t]||[],i=r.some((e=>((0,R.FA)(e)?.catalogItems||[]).some((e=>"LIST"===e.displayType)))),n=r.some((e=>((0,R.FA)(e)?.catalogItems||[]).some((e=>"GRID"===e.displayType))));return`${E} ${i&&n?"Mixed":i?"List":"Grid"}`};function I(e){let{store:t,isLegacyStorePayload:E,activeSectionUuid:n}=e;const u=(0,r.Tz)(),c=S((0,i.Z)()),T=(0,o.d)(),I=D(t.uuid),l=(0,a.ZP)(),N=function(e){return"USE_SECTION_AS_CATEGORY"===e.menuDisplayType?1:e.sections?.length||0}(t),U=(0,R.dK)(t.catalogSectionsMap||{}),A=t.timing,p=t.parentChain?.uuid||"",P=t.citySlug||"",{title:f,uuid:C,currencyCode:L,status:y,isVirtualized:m,isLost:V}=(0,O.TG)(t),M=t.storeInfoMetadata?.storeAvailablityStatus?.state,{activePreferenceType:g}=(0,_.Z)(t.uuid),h="USE_SECTION_AS_CATEGORY"===t.menuDisplayType?"grocery":"restaurant",b=d(t,n);(0,s.useEffect)((()=>{A&&l("eats:store",{store:{title:f,uuid:C,currencyCode:L,status:y,isVirtualized:m,isLost:V},isLegacyStorePayload:E,storeAvailabilityState:M,activePreferenceType:g,vertical:h,slug:P,storeMainView:{previousPath:u,diningMode:T,numMenus:N,numItems:U,chainUUID:p,orderRole:c,deliveryTime:I,storeLayout:b,loadTime:A}})}),[l,f,C,L,M,y,V,E,g,P,u,T,U,N,h,p,c,I,b,A,m])}function l(){const e=(0,a.ZP)(),t=(0,i.Z)();return function(E,r,i){e("eats:store_menu_switcher_select",{storeMenuSwitcher:{storeUUID:E,isMenuOpen:r,orderRole:S(t),merchantType:i||""}})}}function N(){const e=(0,a.ZP)(),{store:t}=(0,T.QT)(),E=(0,c.Z)(t?.data);return r=>{let{searchSource:i,searchDataInfoLayer:n,searchDataInfoTab:o}=r;if(!t?.data)return;const a=t.data;e("eats:store_search_started",{searchSource:i,storeUuid:a.uuid||"",searchDataInfo:{layer:n,tab:o,locationType:a.location?.locationType},storeLayout:d(a,E)})}}function U(){const{store:e}=(0,T.QT)(),t=(0,a.ZP)(),E=(0,c.Z)(e?.data);return r=>{let{catalogSectionItemEventArgs:i,currentQuery:n}=r;e?.data&&t("eats:store_search_result_click",{storeCatalog:{itemUuid:i.itemUuid,storeUuid:i.storeUuid,position:i.position,query:n},storeLayout:d(e.data,E)})}}},40964:(e,t,E)=>{"use strict";E.d(t,{A:()=>r,E:()=>i});const r=e=>"USE_SECTION_AS_CATEGORY"===e.menuDisplayType,i=e=>r(e)?"grocery":"restaurant"},79640:(e,t,E)=>{"use strict";E.d(t,{JG:()=>a,hK:()=>n,iu:()=>s,xk:()=>_,Kk:()=>o,l2:()=>i});Object.freeze({NONE:"NONE",PILL:"PILL"}),Object.freeze({UNKNOWN:"UNKNOWN",StoreNotOrderable:"StoreNotOrderable",MembershipBenefit:"MembershipBenefit",TOP_EATS:"TOP_EATS",RATINGS:"RATINGS",DISTANCE:"DISTANCE",ETD:"ETD",SPONSORED:"SPONSORED",SCHEDULE_ORDER:"SCHEDULE_ORDER",PICKUP_ORDER:"PICKUP_ORDER",FARE:"FARE",CLOSED:"CLOSED",SURGE_OPTIONALITY:"SURGE_OPTIONALITY",CLOSED_ETA:"CLOSED_ETA",ALLERGY_DISCLAIMER:"ALLERGY_DISCLAIMER",SIGNPOSTS:"SIGNPOSTS",SAVER_DELIVERY:"SAVER_DELIVERY",NEW_STORE:"NEW_STORE"}),Object.freeze({UNKNOWN:"UNKNOWN",EATS_PASS:"EATS_PASS",UBER_ONE:"UBER_ONE",POSTMATES_UNLIMITED:"POSTMATES_UNLIMITED",THIRD_PARTY_ORCHID:"THIRD_PARTY_ORCHID"}),Object.freeze({UNKNOWN:"UNKNOWN",MEET_AT_DOOR:"MEET_AT_DOOR",LEAVE_AT_DOOR:"LEAVE_AT_DOOR"}),Object.freeze({PLAIN:"PLAIN",BANNER:"BANNER"}),Object.freeze({UNKNOWN:"UNKNOWN",BOTTOM_SHEET:"BOTTOM_SHEET",COMPLETE_ORDER:"COMPLETE_ORDER",CALL_PHONE:"CALL_PHONE",REQUEST_ORDER_UPDATE:"REQUEST_ORDER_UPDATE",NAVIGATE_TO_STORE:"NAVIGATE_TO_STORE",TIP:"TIP",OPEN_MULTI_RESTAURANT_DRAWER:"OPEN_MULTI_RESTAURANT_DRAWER",MEMBERSHIP:"MEMBERSHIP",SHOW_ORDER_DETAILS:"SHOW_ORDER_DETAILS",ORDER_NOT_YET_READY:"ORDER_NOT_YET_READY",RIDE_TO_STORE:"RIDE_TO_STORE",AUTONOMOUS_DELIVERY_UNLOCK_VEHICLE:"AUTONOMOUS_DELIVERY_UNLOCK_VEHICLE",AUTONOMOUS_DELIVERY_FIND_VEHICLE:"AUTONOMOUS_DELIVERY_FIND_VEHICLE",AUTONOMOUS_DELIVERY_CALL_OPERATOR:"AUTONOMOUS_DELIVERY_CALL_OPERATOR",AUTONOMOUS_DELIVERY_CONTACT_SUPPORT:"AUTONOMOUS_DELIVERY_CONTACT_SUPPORT",UPDATE_DELIVERY_INSTRUCTIONS:"UPDATE_DELIVERY_INSTRUCTIONS",BOOK_UBER_RIDE:"BOOK_UBER_RIDE",UPDATE_DELIVERY_ADDRESS:"UPDATE_DELIVERY_ADDRESS",UPDATE_INTERACTION_TYPE:"UPDATE_INTERACTION_TYPE",AUTONOMOUS_DELIVERY_RECEIVE_ORDER:"AUTONOMOUS_DELIVERY_RECEIVE_ORDER",AUTONOMOUS_DELIVERY_RECEIVE_ORDER_CONFIRM:"AUTONOMOUS_DELIVERY_RECEIVE_ORDER_CONFIRM",AUTONOMOUS_DELIVERY_RECEIVE_ORDER_DISMISS:"AUTONOMOUS_DELIVERY_RECEIVE_ORDER_DISMISS",SCHEDULE_ORDER:"SCHEDULE_ORDER",VIEW_STORE:"VIEW_STORE",UPDATE_COMPLIANCE_CONSENTS:"UPDATE_COMPLIANCE_CONSENTS",AUTONOMOUS_DELIVERY_HONK_HORN:"AUTONOMOUS_DELIVERY_HONK_HORN",CREATE_SAME_STORE_ADD_ON_ORDER:"CREATE_SAME_STORE_ADD_ON_ORDER",VIEW_RECEIPT:"VIEW_RECEIPT",LAUNCH_LIVE_ORDER_EDITING:"LAUNCH_LIVE_ORDER_EDITING",UPDATE_REPLACEMENT_PREFERENCES:"UPDATE_REPLACEMENT_PREFERENCES"}),Object.freeze({TOP_CENTERED:"TOP_CENTERED",FULL_WIDTH:"FULL_WIDTH",FULL_HEIGHT:"FULL_HEIGHT"}),Object.freeze({UNKNOWN:"UNKNOWN",PRIMARY_STORE:"PRIMARY_STORE",ADD_ON_STORE:"ADD_ON_STORE"}),Object.freeze({UNKNOWN:"UNKNOWN",COPY:"COPY"}),Object.freeze({DYNAMIC_BOOKING_FEE:"DYNAMIC_BOOKING_FEE",BUSY_AREA_FEE:"BUSY_AREA_FEE",MEAL_VOUCHER:"MEAL_VOUCHER",ORDER_HISTORY:"ORDER_HISTORY",BANDWAGON:"BANDWAGON",ALLERGEN_DISCLAIMER:"ALLERGEN_DISCLAIMER",AGGREGATOR_STOREFRONT:"AGGREGATOR_STOREFRONT",UNKNOWN:"UNKNOWN",OTHER_FEES:"OTHER_FEES",SERVICE_FEES:"SERVICE_FEES",FEE_DISCLAIMER:"FEE_DISCLAIMER",BASKET_SIZE:"BASKET_SIZE",RESERVED_12:"RESERVED_12",RESERVED_13:"RESERVED_13",RESERVED_14:"RESERVED_14",RESERVED_15:"RESERVED_15",RESERVED_16:"RESERVED_16",RESERVED_17:"RESERVED_17"}),Object.freeze({DEFAULT:"DEFAULT",COLLAPSED:"COLLAPSED",REQUIRED_SINGLE_OPTION:"REQUIRED_SINGLE_OPTION",IMAGE_TILE_PRESENTATION:"IMAGE_TILE_PRESENTATION",RESERVED_4:"RESERVED_4",RESERVED_5:"RESERVED_5",RESERVED_6:"RESERVED_6"}),Object.freeze({ANY_STORE:"ANY_STORE",IS_BASKET_FROM_SAME_STORE:"IS_BASKET_FROM_SAME_STORE",IS_BASKET_NOT_FROM_SAME_STORE:"IS_BASKET_NOT_FROM_SAME_STORE",RESERVED_3:"RESERVED_3",RESERVED_4:"RESERVED_4",RESERVED_5:"RESERVED_5",RESERVED_6:"RESERVED_6"});const r=Object.freeze({UNKNOWN:"UNKNOWN",BYOC:"BYOC",TOP_EATS:"TOP_EATS",TOP_EATS_PROMISE:"TOP_EATS_PROMISE",EATS_PROMISE:"EATS_PROMISE"});Object.freeze({UNKNOWN:"UNKNOWN",BYOC:"BYOC",TOP_EATS:"TOP_EATS",IN_STORE_PRICING:"IN_STORE_PRICING",ETA:"ETA"}),Object.freeze({NONE:"NONE",LINE:"LINE",SPACE:"SPACE"}),Object.freeze({UNKNOWN:"UNKNOWN",NO_RUSH_DELIVERY:"NO_RUSH_DELIVERY",STANDARD_DELIVERY:"STANDARD_DELIVERY",PREMIUM_DELIVERY:"PREMIUM_DELIVERY",ETD_SURGE_DELIVERY:"ETD_SURGE_DELIVERY",OPT_IN_TYPE_RESERVED_5:"OPT_IN_TYPE_RESERVED_5",OPT_IN_TYPE_RESERVED_6:"OPT_IN_TYPE_RESERVED_6",OPT_IN_TYPE_RESERVED_7:"OPT_IN_TYPE_RESERVED_7"}),Object.freeze({UNKNOWN:"UNKNOWN",ANIMATED_BACKGROUND_VIEW:"ANIMATED_BACKGROUND_VIEW"});function i(e){return Boolean(e)&&"geolocation_api"!==e?.originType}function n(e,t){return e.indicatorIcons&&e.indicatorIcons.find((function(e){if("typeV2"in e&&e.typeV2===t)return e;if("type"in e&&e.type===t){return t in r?e:null}}))}function o(e){return null!=e&&Boolean(n(e,"ETA"))}function a(e){let{itemStyle:t,isGrocery:E}=e;return t?.imageContentMode?"FIT"===t.imageContentMode?"contain":"cover":E?"contain":"cover"}function _(e){return"USE_SECTION_AS_CATEGORY"===e.menuDisplayType?Object.keys(e.catalogSectionsMap||{})[0]:(e.sections||[]).find((e=>e.isTop))?.uuid||e.sections[0]?.uuid}const s=e=>function(e){return void 0!==e.itemDescription}(e)&&e.isLegacy&&e.description?e.description:function(e){return void 0!==e.itemDescriptionBadge}(e)?e.itemDescriptionBadge?e.itemDescriptionBadge?.text||"":e.itemDescription||"":e.itemDescription?e.itemDescription:""},34274:(e,t,E)=>{"use strict";E.d(t,{Z:()=>O});var r=E(36151),i=E(15070),n=E(87696),o=E(92431),a=E(4434),_=E.n(a),s=E(99317);function O(e){const t=(0,o.Z)(),E=(0,r.useCallback)(_()((e=>{(0,n.On)(t,e)})),[]),a=(0,i.v)((e=>{let{countdowns:t}=e;return t})),O=(0,s.VA)({countdowns:a&&a.data||[],countdownLabel:"BANDWAGON",feedItemUuid:e.feedItemUuid,storeUuid:e.storeUuid}),u=(0,r.useRef)(!1),c=(0,r.useRef)(!1),T=(0,n.Ty)(t);if(T){u.current=(T.storeUuids||[]).includes(e.storeUuid);const t=R(Date.now()),E=R(T.timestampEnd);c.current=t<E}return(0,r.useEffect)((()=>{O&&!u.current&&E({storeUuids:O.storeUuids,timestampEnd:O.timestamp.end}),u.current&&!c.current&&E(null)}),[O,E]),Boolean(O||u.current&&c.current)}const R=e=>parseInt(e/1e3)},33825:(e,t,E)=>{"use strict";E.d(t,{Z:()=>n});var r=E(91631);const i=["nugget","start-group-order","share-group-order","lock-group-order","cancel-group-order","store-info","store-info-byoc","menus","error"];function n(){const e=(0,r.UO)();return i.includes(e.sectionUuid||"")}},99317:(e,t,E)=>{"use strict";E.d(t,{Ix:()=>a,VA:()=>_,WQ:()=>o});var r=E(68799);const i="uev2.bandwagon",n=(e,t)=>({"0%":{backgroundColor:`${e}`},"45%":{backgroundColor:`${t}`},"55%":{backgroundColor:`${t}`},"100%":{backgroundColor:`${e}`}}),o=e=>({alignItems:"center",animationDelay:"4s",animationDuration:"2.5s",animationIterationCount:"infinite",animationName:e.shouldPulse?n(e.theme.colors.positive,e.theme.colors.positive300):"none",backgroundColor:e.shouldPulse?e.theme.colors.positive:e.theme.colors.positive50,color:e.shouldPulse?e.theme.colors.onPositive:e.theme.colors.onPositive50,display:"flex",justifyContent:"center",height:e.height?`${e.height}px`:"auto",overflow:"hidden"}),a=e=>{const t=(0,r.Z7)(i).count;if(e){const e=t?t+1:1;e<=5&&(0,r.pc)(i,{count:e})}return{count:t,reachedLimit:t>=5}},_=e=>(e.anyUuid||e.feedItemUuid||e.storeUuid)&&e.countdowns.find((t=>t.timerValidLabel===e.countdownLabel&&(e.anyUuid||t.feedItemUuids.includes(e.feedItemUuid)||t.storeUuids.includes(e.storeUuid))))||null}}]);