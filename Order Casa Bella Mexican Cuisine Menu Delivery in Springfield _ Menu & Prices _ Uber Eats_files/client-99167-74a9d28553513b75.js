"use strict";(self.webpackChunkFusion=self.webpackChunkFusion||[]).push([[99167],{59624:(t,e,i)=>{i.d(e,{Z:()=>l});var n=i(36151),o=i(79406),r=i(75267);const s=(t,e)=>e;class a extends n.Component{static defaultProps={accessibilityType:o.SI.menu,ignoreBoundary:!1,overrides:{},onMouseEnterDelay:200,onMouseLeaveDelay:200,placement:o.r4.auto,popperOptions:{},showArrow:!1,triggerType:o.gu.click,dismissOnClickOutside:!0,dismissOnEsc:!0,stateReducer:s,popoverMargin:o.AF};state={isOpen:!1,...this.props.initialState};onBlur=t=>{this.props.onBlur&&this.props.onBlur(t),this.props.focusLock||this.props.autoFocus||this.close()};onClick=t=>{this.props.onClick&&this.props.onClick(t),this.state.isOpen?this.close():this.open()};onClickOutside=()=>{this.close()};onEsc=()=>{this.close()};onFocus=t=>{this.props.onFocus&&this.props.onFocus(t),(0,r.E)(t)&&this.open()};onMouseEnter=t=>{this.props.onMouseEnter&&this.props.onMouseEnter(t),this.open()};onMouseLeave=t=>{this.props.onMouseLeave&&this.props.onMouseLeave(t),this.close()};onContentClose=()=>{this.close()};open(){this.internalSetState(o.oL.open,{isOpen:!0}),this.props.onOpen&&this.props.onOpen()}close(){this.internalSetState(o.oL.close,{isOpen:!1}),this.props.onClose&&this.props.onClose()}internalSetState(t,e){const{stateReducer:i}=this.props;"function"==typeof i?this.setState((n=>i(t,e,n))):this.setState(e)}renderContent=()=>{const{content:t}=this.props;return"function"==typeof t?t({close:this.onContentClose}):t};render(){const{accessibilityType:t,autoFocus:e,animateOutTime:i,dismissOnClickOutside:n,dismissOnEsc:r,focusLock:s,ignoreBoundary:a,mountNode:l,onBlur:c,onClick:u,onFocus:d,onMouseEnter:p,onMouseLeave:h,onMouseEnterDelay:m,onMouseLeaveDelay:y,overrides:b,placement:g,popperOptions:f,renderAll:C,returnFocus:Z,showArrow:v,triggerType:k,popoverMargin:$,focusOptions:I}=this.props,B={accessibilityType:t,animateOutTime:i,autoFocus:e,content:this.renderContent,focusLock:s,ignoreBoundary:a,isOpen:this.state.isOpen,mountNode:l,onBlur:c,onClick:u,onFocus:d,onMouseEnter:p,onMouseLeave:h,onMouseEnterDelay:m,onMouseLeaveDelay:y,overrides:b,placement:g,popperOptions:f,renderAll:C,returnFocus:Z,showArrow:v,triggerType:k,popoverMargin:$,focusOptions:I};return n&&(B.onClickOutside=this.onClickOutside),r&&(B.onEsc=this.onEsc),k===o.gu.hover?(B.onBlur=this.onBlur,B.onFocus=this.onFocus,B.onMouseEnter=this.onMouseEnter,B.onMouseLeave=this.onMouseLeave):B.onClick=this.onClick,this.props.children(B)}}const l=a},67284:(t,e,i)=>{i.d(e,{Z:()=>l});var n=i(79406),o=i(59624),r=i(69890),s=i(33990);function a(t){const{children:e,...i}=t;return(0,s.tZ)(o.Z,{...i,children:t=>(0,s.tZ)(r.Z,{...t,children:e})})}a.defaultProps={accessibilityType:n.SI.menu,ignoreBoundary:!1,overrides:{},onMouseEnterDelay:200,onMouseLeaveDelay:200,placement:n.r4.auto,showArrow:!1,triggerType:n.gu.click,dismissOnClickOutside:!0,dismissOnEsc:!0,stateReducer:(t,e)=>e,popoverMargin:n.AF};const l=a},38379:(t,e,i)=>{i.d(e,{y:()=>d});var n=i(91931),o=i(52298),r=i(22787),s=i(39010),a=i(89400),l=i(33990);const c=(0,n.zo)("div",(t=>{let{$theme:e}=t;return{...e.typography.HeadingXSmall,color:e.colors.contentPrimary}})),u=(0,n.zo)("div",(t=>{let{$theme:e}=t;return{...e.typography.ParagraphSmall,color:e.colors.contentPrimary}}));function d(t){let{bottomSheet:e}=t;return(0,l.BX)(l.HY,{children:[e.title?(0,l.tZ)(c,{children:e.title.text}):null,e.body?(0,l.BX)(u,{children:[(0,l.tZ)(o.ZP,{$height:16}),(0,l.tZ)(a.Z,{badge:e.body})]}):null,(0,l.tZ)(s.U,{paragraphs:e.paragraphs}),e.secondaryButtonText&&e.url?(0,l.BX)(l.HY,{children:[(0,l.tZ)(o.ZP,{$height:24}),(0,l.tZ)(r.Z,{$as:"a",href:e.url,target:"_blank",children:e.secondaryButtonText})]}):null]})}},45474:(t,e,i)=>{i.d(e,{BY:()=>c,ZP:()=>p,b:()=>d,xE:()=>h});var n=i(36151),o=i(67284),r=i(91931),s=i(32562),a=i(94579),l=i(33990);const c=330,u=(0,r.zo)("div",{position:"relative",display:"flex"}),d=(0,r.zo)("div",(t=>{let{$isVisible:e,$theme:i,$color:n="backgroundPrimary",$border:o="borderSecondary"}=t;return{position:"absolute",border:`1px solid ${i.colors[o]}`,zIndex:a.I_.foreground,top:"100%",left:`calc(50% - ${c/2}px)`,backgroundColor:i.colors[n],padding:"16px",width:`${c}px`,boxSizing:"border-box",boxShadow:"0px 0px 25px rgba(0, 0, 0, 0.1)",transition:"all 150ms 50ms",backfaceVisibility:"hidden",marginTop:"24px",...e?{clip:"auto",overflow:"visible",opacity:1}:{clip:"rect(0 0 0 0)",overflow:"hidden",opacity:0}}}));function p(t){const e=n.useRef(null),i=(0,s.Z)(e);return(0,l.tZ)(u,{role:"tooltip",id:t.id,ref:e,children:t.children({isHovering:i})})}const h=t=>{let{id:e,content:i,children:n,$color:r="backgroundPrimary",$border:s="borderSecondary"}=t;return(0,l.tZ)(o.Z,{id:e,content:i,accessibilityType:"tooltip",triggerType:"hover",placement:"bottom",overrides:{Body:{style:t=>{let{$theme:e}=t;return{width:`${c}px`,margin:e.sizing.scale300,border:`1px solid ${e.colors[s]}`,boxSizing:"border-box",boxShadow:"0px 0px 25px rgba(0, 0, 0, 0.1)"}}},Inner:{style:t=>{let{$theme:e}=t;return{backgroundColor:e.colors[r],padding:e.sizing.scale600}}}},children:n})}},19910:(t,e,i)=>{i.d(e,{d:()=>u});var n=i(36151),o=i(44606),r=i(6264),s=i(44997),a=i(78227),l=i(55089);const c=(t,e,i,n)=>{if("AVAILABLE"===t.current.status||"SYNCING"===t.current.status){const r="number"==typeof e?o.Tf.from(e).toBaseDecimal():e;return{...(0,a.Z)(n?.purchaseInfo?.purchaseOptions?.[0],t.current.rawCartData?.cartQuantities?.[i]),currentQuantity:r}}return(0,a.Z)(n.purchaseInfo?.purchaseOptions?.[0])},u=()=>{const{liveOrderUuid:t}=(0,s.W)(),e=(0,r.W)({getCartFrom:"workflowId",workflowId:t}),i=(0,n.useRef)(e);i.current=e;return(0,n.useCallback)((async t=>{if("cart"===t.type){const{num:e,skuUuid:n,cartItemUuid:o,fulfillmentIssueAction:r,specialInstructions:s}=t;if("AVAILABLE"===i.current.status||"SYNCING"===i.current.status){const t=c(i,e,n,void 0);return i.current.actions.editCartItem({item:{type:"cart",newQuantity:t,skuUuid:n,specialInstructions:s??"",fulfillmentIssueAction:r,cartItemId:o}})}}else if("store"===t.type){const{num:e,skuUuid:n,storeItem:r,storeIdentifier:s,sellingOption:a,fulfillmentIssueAction:u,specialInstructions:d}=t;if("AVAILABLE"===i.current.status||"SYNCING"===i.current.status){const t=c(i,e,n,r);return i.current.actions.editCartItem({item:{type:"store",skuUuid:n,newQuantity:t,customizations:{},specialInstructions:d??"",fulfillmentIssueAction:u,cartItem:{uuid:r.uuid??"",shoppingCartItemUuid:(0,l.Z)(),storeUuid:s.storeUuid??"",sectionUuid:s.sectionUuid??"",subsectionUuid:s.subsectionUuid??"",price:Number(r.price),title:r.title??"",quantity:"UNIT"===t.type?o.Tf.from(t.currentQuantity).toInt():1,imageURL:String(r.imageUrl??""),pricedByUnit:r.purchaseInfo?.pricingInfo?.pricedByUnit,soldByUnit:a?.soldByUnit??r.purchaseInfo?.purchaseOptions?.[0]?.soldByUnit}}})}}}),[])}},3695:(t,e,i)=>{i.d(e,{Z:()=>$});var n=i(5639),o=i(84089),r=i(56899),s=i(66041),a=i(59210),l=i(32857),c=i(68065),u=i(91931),d=i(33990);const p=(0,u.zo)("div",(t=>{let{$theme:e}=t;return{padding:`${e.sizing.scale100} ${e.sizing.scale600} ${e.sizing.scale600} ${e.sizing.scale600}`,display:"flex",justifyContent:"flex-end",alignItems:"center"}})),h=t=>{let{onClose:e,orderValidationError:i}=t;return(0,d.BX)(o.Z,{isOpen:!0,closeable:!0,onClose:e,size:r.NO.default,children:[(0,d.tZ)(s.xB,{children:(0,d.tZ)(a.TE,{margin:"0",children:i.alert?.title?.text})}),(0,d.tZ)(s.fe,{children:(0,d.tZ)(a.kd,{children:i.alert?.body?.text})}),(0,d.tZ)(p,{children:(0,d.tZ)(l.Z,{size:c.NO.large,onClick:t=>{t.stopPropagation(),e()},children:i?.alert?.primaryButton?.title})})]})};var m=i(58679);const y=(0,u.zo)("div",(t=>{let{$theme:e}=t;return{padding:`${e.sizing.scale600} 0`}})),b=t=>{let{onClose:e,orderValidationError:i}=t;const n=t=>{t.stopPropagation(),e()};return(0,d.BX)(m.R1,{onBackdropClick:n,children:[(0,d.tZ)(m._g,{children:(0,d.tZ)(a.fH,{margin:"0",children:i.alert?.title?.text})}),(0,d.BX)(m.bd,{children:[i.alert?.body?.text,(0,d.tZ)(y,{children:(0,d.tZ)(l.Z,{overrides:{BaseButton:{style:{width:"100%"}}},onClick:n,children:i?.alert?.primaryButton?.title})})]})]})};var g=i(74622),f=i(76150),C=i(94813),Z=i(44997),v=i(47986),k=i(91631);const $=t=>{let{orderValidationError:e,onClose:i}=t;const{liveOrderUuid:o}=(0,Z.W)(),r=(0,k.k6)(),s=(0,C.TH)(),a=(0,g.useQueryClient)(),{hideSidebarCart:l}=(0,f.Lb)(),{isMobile:c}=(0,n.hU)();if(!e)return null;const u=async()=>{"LIVE_ORDER_EDIT_AFTER_SHOPPING_COMPLETE"===e?.type&&(await a.invalidateQueries(["getActiveOrdersV1"]),l(),r.replace((0,v._u3)(s,{uuid:o}))),i()};return c?(0,d.tZ)(b,{onClose:u,orderValidationError:e}):(0,d.tZ)(h,{onClose:u,orderValidationError:e})}},78227:(t,e,i)=>{i.d(e,{Z:()=>r});var n=i(44606),o=i(66958);function r(t,e){switch(e?.type){case"WEIGHT":case"UNIT":return e;case"UNKNOWN":default:{const i="MEASUREMENT_TYPE_WEIGHT"===t?.soldByUnit?.measurementType?"WEIGHT":"UNIT",r="UNIT"===i?n.Tf.from(t?.quantityConstraintsV2?.minPermitted??t?.quantityConstraintsV2?.defaultQuantity??o.wI.minimumQuantity).toBaseDecimal():n.Tf.from(t?.quantityConstraintsV2?.minPermitted??o.wI.minimumQuantity).toBaseDecimal(),s=n.Tf.from(t?.quantityConstraintsV2?.maxPermitted??o.wI.maximumQuantity).toBaseDecimal(),a=t?.itemQuantityAbbreviation??"",l=n.Tf.from(t?.quantityConstraintsV2?.increment??o.wI.incrementQuantity).toBaseDecimal(),c=e?.totalQuantityWithCustomizations??n.Tf.from(0).toBaseDecimal();return{type:i,suffix:a,step:l,currentQuantity:e?.currentQuantity??n.Tf.from(0).toBaseDecimal(),totalQuantityWithCustomizations:c,maxQuantity:s,minQuantity:r}}}}},95768:(t,e,i)=>{i.d(e,{Z:()=>z});var n=i(43193),o=i(36151),r=i(14016),s=i(91931),a=i(33497),l=i(57444),c=i(57597),u=i(66958),d=i(87444),p=i(53213),h=i(53890),m=i(44606),y=i(72179),b=i(78422),g=i(32857),f=i(33535),C=i(33990);const Z=t=>`${t}px`,v=36,k=Z(v),$=(t,e)=>!t||!e||e<v?v:e+8,I=(t,e)=>-(60-$(t,e)/2),B=(0,s.zo)("div",(t=>{let{$theme:e,disabled:i,$isSecondary:n,$isClosed:o,$hasQuantity:r,$quantityWidth:s}=t;return{position:"relative",width:Z(o?$(r,s):120),height:Z(36),transition:"width 100ms linear",borderRadius:e.borders.pillButtonBorderRadius,overflow:"hidden",background:e.colors.buttonPrimaryFill,color:e.colors.buttonPrimaryText,cursor:"auto",...n&&{background:e.colors.buttonSecondaryFill,color:e.colors.buttonSecondaryText},...i&&{...(0,l.Z)(e)}}})),T=(0,s.zo)("div",(t=>{let{$isClosed:e,$hasQuantity:i,$quantityWidth:n}=t;return{position:"absolute",right:i&&e?Z(I(i,n)):0,transition:"right 100ms linear",width:Z(120),display:"flex",justifyContent:"space-between",alignItems:"center"}})),S=(0,s.zo)("button",(t=>{let{$theme:e,$isSecondary:i,$isClosed:n,$hasQuantity:o,$quantityWidth:r}=t;return{...(0,a.Z)({$theme:e,radius:"pillButtonBorderRadius"}),width:k,minWidth:k,height:k,minHeight:k,padding:0,display:"flex",justifyContent:"center",alignItems:"center",background:"transparent","@media (hover: hover)":{":hover":{background:i?e.colors.buttonSecondaryHover:e.colors.contentTertiary}},":active":{background:i?e.colors.buttonSecondaryHover:e.colors.contentTertiary},":disabled":{color:e.colors.contentStateDisabled,fill:e.colors.disabled,background:"transparent"},...n&&{width:Z($(o,r)),minWidth:Z($(o,r)),height:Z(v),minHeight:Z(v),margin:0,...Boolean(r)&&{padding:"0 4px"}}}})),x=(0,s.zo)("div",(t=>{let{$theme:e}=t;return{position:"absolute",left:"50%",transform:"translateX(-50%)",...e.typography.LabelLarge,display:"flex",justifyContent:"center",alignItems:"center",whiteSpace:"nowrap",textAlign:"center"}})),E=(0,s.zo)("div",(t=>{let{$theme:e}=t;return{...e.typography.LabelSmall,textWrap:"nowrap"}})),O=(0,s.zo)("div",(t=>{let{$theme:e}=t;return{display:"flex",justifyContent:"space-between",alignItems:"center",minWidth:Z(88),backgroundColor:e.colors.backgroundSecondary,borderRadius:e.sizing.scale700}})),w=t=>(0,C.tZ)(g.Z,{kind:"secondary",size:"compact",shape:"circle",onClick:t.onClick,overrides:{BaseButton:{style:t=>{let{$theme:e}=t;return{backgroundColor:e.colors.backgroundSecondary,":hover":{backgroundColor:e.colors.backgroundSecondary}}}}},...t,children:t.children}),L=t=>{const e=(0,r.T)();return(0,C.tZ)(w,{disabled:t.isDisabled||t.getQuantityLimit()!==c.y.BELOW_LIMIT,onClick:t.onPlus,"aria-label":e("shared.increment"),children:(0,C.tZ)(b.Z,{name:"PlusSmallFilled",size:20})})},M=t=>{let{type:e="primary",isClosable:i=!1,isDisabled:s=!1,item:a,storeUuid:l,quantity:g,updateQuantity:Z,isRemovable:v=!0,overrideQuantityConstraints:k,overridingMeasurementType:$,analyticsLabel:I}=t;const{isCartDrafting:M}=(0,y.Z)(),z=m.Tf.from(g),Q=(0,c.Z)({item:a,storeUuid:l,cartQuantity:z.toInt(),overrideQuantityConstraints:k}),U=(0,r.T)(),F="secondary"===e,P="primary"===e,A=(0,d.Z)("price_items_by_weight")&&(0,u.jx)(a,$),D=(0,u.L5)(a,k),W=A&&D.minimumQuantity||1,N=m.Tf.from(g).lte(W),R=(0,f.ZP)(),_=n.useRef(!1),V=(0,o.useMemo)((()=>A?`${z.toFloat()} ${(0,u.YP)(a)||""}`:z.toFloat()),[z,A,a]);(0,o.useEffect)((()=>{_.current&&R("eats:item_quantity_update",{quantity:z.toFloat(),analyticsLabel:I}),_.current=!1}),[I,z,R]);const[q,H]=(0,o.useState)(!1),X=i&&!q,G=(0,o.useCallback)((()=>{Z(h.TX.decrement),_.current=!0,i&&N&&H(!1)}),[i,N,Z]),Y=(0,o.useCallback)((()=>{i&&H(!0)}),[i]),j=(0,o.useCallback)((()=>{Z(h.TX.increment),_.current=!0}),[Z]),[K,J]=(0,o.useState)(0),tt=(0,o.useRef)(null);(0,o.useEffect)((()=>{V&&tt.current?.clientWidth&&J(tt.current.clientWidth)}),[V]);const et=(0,o.useRef)(null);(0,p.Z)(et,(()=>{H(!1)}),i&&q);const it=s||(v?z.isLt(W):z.isLte(W));return M&&P&&!g?(0,C.tZ)(L,{isDisabled:s,getQuantityLimit:Q,onPlus:j}):M&&F||M&&P&&Boolean(g)?(0,C.BX)(O,{children:[(0,C.tZ)(w,{disabled:s,onClick:G,"aria-label":U("shared.decrement"),"data-test":"item-stepper-dec",children:z.isGt(W)||!v?(0,C.tZ)(b.Z,{name:"MinusSmallFilled",size:20}):N?(0,C.tZ)(b.Z,{name:"TrashCanOutlined",size:16}):null}),(0,C.tZ)(E,{ref:tt,children:V}),(0,C.tZ)(L,{isDisabled:s,getQuantityLimit:Q,onPlus:j})]}):(0,C.tZ)(B,{ref:et,disabled:s,$isSecondary:F,$isClosed:X,$hasQuantity:Boolean(g),$quantityWidth:K,"data-test":"item-stepper",children:(0,C.BX)(T,{$isClosed:X,$hasQuantity:Boolean(g),$quantityWidth:K,children:[(0,C.tZ)(S,{disabled:it,$isSecondary:F,$isClosed:X,onClick:G,"aria-label":U("shared.decrement"),"data-test":"item-stepper-dec",children:z.isGt(W)||!v?(0,C.tZ)(b.Z,{name:"MinusSmallFilled",size:20}):N?(0,C.tZ)(b.Z,{name:"TrashCanFilled",size:16}):null}),(0,C.tZ)(S,{disabled:s||Q()!==c.y.BELOW_LIMIT,$isSecondary:F,$isClosed:X,onClick:j,"aria-label":U("shared.increment"),"data-test":"item-stepper-inc",children:(0,C.tZ)(b.Z,{name:"PlusSmallFilled",size:20})}),(0,C.tZ)(x,{"data-test":"item-stepper-quantity",children:X&&g?(0,C.tZ)(S,{disabled:s,$isSecondary:F,$isClosed:X,$hasQuantity:Boolean(g),$quantityWidth:K,onClick:Y,children:(0,C.tZ)("div",{ref:tt,children:V})}):(0,C.tZ)("div",{ref:tt,children:V})})]})})},z=n.memo(M)}}]);